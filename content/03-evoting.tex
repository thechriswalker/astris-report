
\chapter{E-Voting}
\label{ch:ev}

Electronic Voting by definition covers any electronically assisted form of voting. This could be electronically counted paper votes, or electronic voting machines at a voting booth. However, we will be considering another option, of fully electronic voting where the systems are accessible over the Internet --- similar to the general usage of the term \emph{email}.

\section{Specific Requirements for E-Voting}
\label{ch:ev:specific}

The main difference between in-person voting and remote voting from the point of view of security is the lack of a secure voting booth. Such a booth is often listed as a requirement of in-person voting systems, as an assumption to allow enforcement of the eligibility and secrecy properties. That is a secure voting booth is one where the voter is authenticated on the way in and then their privacy whilst inside casting their vote is guaranteed. While a remote voting system does not preclude the use of such a booth, such a system loses a lot of it's perceived benefits by mandating the use of one. Indeed, it may not be immediately obvious why such a system would have any benefits over a traditional in-person election.

It could be argued that a seemingly obvious benefit --- that people can vote without having to travel to a secure booth --- is not really a benefit at all as we lose the security properties guaranteed by such a booth and the trade off of convenience over security is not worth it. On the other hand remote voting does indeed have some beneficial implications. It would lower the cost of an election as there would be no need to hire a secure location or the people to run it. There would be no need for transportation of the ballots for tallying, and no manual tallying process --- both lowering costs and reducing the likelihood of human error in the tallying. Furthermore, the convenience of not having to travel to a booth is also an enabler for those who would otherwise be unable to make to a booth, potentially increasing the election turnout.

These benefits need to be weighed against the potential security downsides. It is worth noting that there is one insurmountable problem with remote voting which is that there is no possibility to satisfy the coercion-resistance property. This has been addressed in \cite{juelsCoercionResistantElectronicElections2002} and under their definitions the property we are discussing here is \emph{simulation attack} in which the adversary acquires the means to vote on behalf of the user. No matter how secure the voting scheme is from a technical point of view, allowing voting from an arbitrary location via the Internet means that a coercer could stand over the voter during the casting process, a situation which technically indistinguishable from the voter voting alone. In \cite{juelsCoercionResistantElectronicElections2002} the solution is based on the assumption that at some point the voter will be able to vote unhindered and that that vote will be the one counted, any coerced votes would not count and additionally that the unhindered vote could not be linked by the adversary to the voter. This would allow the voter to \emph{pretend} to cooperate with the coercer and separately vote legitimately without the coercer's knowledge (and hence no fear of retribution). The scheme proposed imposes an overhead which is quadratic with respect to the number of voters, which is impractical for large scale elections. Further work has been done to attempt to reduce this overhead to be linear \needcite{on coercion}. As such, remote voting unsuitable for large scale national elections.

Due to these trade-offs we consider how some security properties mentioned in \autoref{ch:req:sec} that take on more or less importance in a remote system and some new security properties that can enhance a remote voting system.

The \textbf{Secrecy} property in a remote voting system becomes more important as now the cast ballot must be sent over a public channel from the voter to the trustees counting the votes. In some respects this is the similar to a paper ballot where, despite the ballot being placed in the ballot box by the voter, the ballot itself must not reveal the voter's identity or the trustees could match votes to voters. However, given that the vote is created by the voter remotely, there is also the transmission of the vote from the voter to the trustees --- analogous to putting a paper vote into a ballot box --- which is now performed over the public Internet, rather than within a secure voting booth.

The \textbf{Robustness} property in a remote voting system becomes more important as by definition the system will have computer systems at various boundaries which by necessity will be accessible over the public Internet. \Gls{dos} attacks against parts of the system will become a valid threat against the system continuing to function correctly. The more entities are in play in the system --- e.g. the Authority, Registrar, Trustees, Voter, Bulletin Board --- the more opportunity for an adversary to disrupt the communication channels between them. This works both ways as with fewer single entities responsible for each function in the system, the more work an adversary will have to disrupt \emph{all} of them. Therefore, remote voting systems must consider single points of failure and the public accessible nature of the system very carefully.

The \textbf{Eligibility} property is vital in all voting systems. Great care must be taken in remote voting systems to ensure eligibility, as we must authenticate the voters remotely and the protocol used must be secure. A failure in the authentication protocol would undermine the entire system. \itodo{I need more in this paragraph.}

The \textbf{Receipt-Freeness} property is primarily a factor adding to \emph{coercion-resistance} and a protection against vote-buying. With the fact that coercion-resistance is impossible for remote voting systems, it might be tempting to write-off receipt-freeness as unimportant. However, we can still counter all forms of vote-buying and coercion that do not involve physical presence --- which is expensive and logistically difficult on a large scale --- by ensuring receipt-freeness. If there was no receipt-freeness then a voter could use that receipt to prove to a coercer or vote-buyer the way they voted, or make such a proof public. With receipt-freeness this is not possible and without proof, it is unlikely that a coercer or vote-buyer would be willing to believe the voter. Due to this I believe that receipt-freeness is just as important in a remote system as in an in-person system.

\textbf{Real-Time Universal Verifiability} is the property of a system that allows the property of universal verifiability to be conducted in real-time during the election. That is the bulletin board can be monitored in real-time and modifications observed. This would allow an external Auditor to be sure that the data on the bulletin board are not changed in a way that the voting system disallows, and such illegal modifications could be proven to have been made. This property enhances the universal verifiability property with time constraints. No party would be able to, with sufficient ability to break any cryptographic protocols, rewrite the bulletin board data to meet their goals while still validating under the rules of the voting system. They could only attack the system during the election itself, with all data making it onto the bulletin board.

\textbf{Eternal Secrecy} is a property that states that the connection between the voters identity and the vote they cast should never be able to be revealed. This means that any data released on the bulletin board, or during the voting process, should never reveal the link between the voter and their vote even if all the cryptographic protocols used are broken. This means, for example, that a voting system relying on a cryptosystem that can be broken with a quantum computing algorithm while secure today, would not be secure in a future where such quantum computers exist. In that future, all the protections from the cryptosystem will be void. We need to ensure that the link between voter and vote is not compromised even then. Note that such a break before or during an election would break the \emph{fairness} property, as the broken cryptosystem would reveal the state of the election before all votes were cast. So we will assume that this property is concerned with the future, after the end of the election.


\section{Existing Systems Analysis}
\label{ch:ev:existing}

There are many practical and theoretical remote voting systems, more than could be covered here. So we look at a selection that use a variety of technologies and techniques to achieve their goals, investigate the security properties they have and discuss the trust implication of their structue. See \autoref{table:voting-system-props} for a table of comparison of the various systems and the properties they achieve.

\subsection{Helios}

Helios Voting is an open-source software implementation of a voting system designed by Ben Adida \cite{adidaHeliosWebBasedOpenAudit2008}. It has progressed significantly since the conference in 2008, dropping the initial mix-net approach in favour of the use of homomorphic encryption. The project has always focussed on correctness and auditability and openly claims that is only suitable for \emph{low-coercion} elections \cite{HeliosVotingFAQ}. That is, Helios makes no attempt to provide coercion-resistance.

The current version of the Helios protocol is V3 and this is the version we shall consider. The system is created as a Python program accessible via a web interface using the PostgreSQL database for data storage. The system is shared tenancy, so all users' data are stored in a single, shared database --- except of course that being open-source, anyway is free to run their own private server.

The basic flow of an election is that the creator lists candidates and defines the number of candidates that may be voted for. Additionally, a list of eligible voters may be created or the system may allow anyone to vote. A public/secret keypair is generated for the election and the election can have a number of trustees who each receive a portion of a private key enabling the decryption of votes to be a group operation. Voters cast a vote for each candidate where each is either a 0 or 1 and there are only a predetermined number of 1's allowed. The vote is encrypted with the public key, and the cryptosystem used (Exponential ElGamal) is additively homomorphic. In this way votes may be tallied while still encrypted and the final tally decrypted separately by the group of trustees. This is a simplification for brevity, the full protocol spec is available \cite{HeliosHeliosV3}. Notably it misses out the digital signatures and \glsplural{zkp} used in the protocol.

Helios provides individual and universal verifiability through the publishing of the encrypted votes, along with enough proof to show that voters has voted within the bounds set in the election. The use of \glsplural{zkp} ensures that the votes conform to the correct structure and the homomorphic nature allows them to be tallied without decryption. This allows the encrypted vote data to be published in such a way that anyone can verify a specific vote is present and that the tally is correct. The decryption of the tally also uses proof based on verifiable decryption, so without the key we can still be sure the tally was decrypted correctly providing the full universal verifiability. Note that this does not satisfy our definition of auditability which enforces that we must be able to discern the correct behaviour during and after the election and detect tampering. During the election the cast votes may be listed, but the onus is on the observer to prove that the list has been tampered with, Helios does not provide such. Once the result is published, the individual and universal verifiability properties combined allow any voter to check that their vote was included in that tally. Therefore, it stands to reason that an adversary, even with full access to the server running the election, could not remove votes without chance of detection. However, the Helios protocol does not forbid such an adversary the ability to create simulated votes for the absentee voters before calculating the totals. This implies that a high level of trust is required in the authority running the Helios server.

By default, the Helios elections name voters by \gls{pii} --- in this case their email address. While this does not directly break the secrecy property directly, eternal secrecy is broken. Helios does have the ability to only identity voters by an alias which is a unique identifier not related to the individual and unique in each election. Provided the link between the voter and the alias is removed after the tallying, the eventual breaking of the cryptography would still not reveal the identity of the voter. Again, a dishonest server administrator could obtain that information from the server before it was removed, which implies a level of trust in the authority running the server, but not more so than already existed.

The votes in Helios are encrypted by the client, before posting to the server. This means we do not need to trust the server with unencrypted votes. The encryption process itself however requires the client to generate some randomness to use during encryption and subsequently destroy it. This randomness could be used to prove which candidate the vote was for and so breaks the receipt-freeness property.

\subsection{Belenios}

Belenios was heavy influenced by Helios, and the original implementation was indeed a fork of the Helios source code adding a distributed key setup for the trustees \cite{cortierBeleniosSimplePrivate2019}. It was subsequently re-implemented from scratch, but the protocol shows many similarities.

A variant, BeleniosRF, enhances the protocol to provide receipt-freeness by use of a re-randomization step. The votes are encrypted and signed using the ElGamal cryptosystem, and a random number is required for each encryption. The knowledge of that number can prove your vote and so provide a receipt. The randomness is generated by the client, and so could be kept to provide that receipt to the voter. In BeleniosRF the encrypted vote and signature can be re-randomized at the voting server and a new valid signature created without the signing key. The voting server does not know the original vote as it is encrypted and the final cast vote is encrypted with randomness that the voter does not know, hence the protocol is reciept-free.

A second variant, BeleniosVS goes further and provides a mechanism by which the vote does not even need to trust their own client. This is achieved by the vote being provided with a voting sheet ahead of time with the encrypted and signed votes already prepared. This sheet would also contain the randomness used for each encryption, so the voter can verify the encrypted values are correct. Combined with the BeleniosRF system for re-randomization, the vote is receipt-free and the user does not have to trust their own device. This system seems like it would be an excellent fit for an election with a secure voting booth. The booth provides the guaranteed isolation and the use of pre-prepared encryptions of votes means the voter need not trust the devices used for the voting.

\subsection{Estonian i-Voting}

\needcite{estonia ivoting}

Estonia has embraced remote voting and has been used to run state level parliamentary elections since 2005.

\todo{
    The i-Voting system is documented, it relies on eligibility via the smart cards and the estonian national PKI. These cards are used for all governmental actions, except marriage, divorce and real-estate

    The system uses asymetic encryption with the smart card and uses a 2-level encryption and mix-net. The vote is encrypted with the public key for the election (provided as part of the PKI) and the encrypted vote is signed with the key of the user. The vote server recieves the user's vote and check the signature, unpacks the vote and then submits it into the wider system.

    questions: secrecy? probably, but in the system the voter->vote may still be accessible. maybe the vote server holds the votes until time to release (catching double votes - the system is last vote wins).

    All the data is in the paper...
}

\subsection{Bitcoin voting proposal - Zhao}

\cite{zhaoHowVotePrivately2016}

\subsection{ZCash voting proposal - Tarasov}

\cite{tarasovInternetVotingUsing2017}

\subsection{Ethereum voting proposal - Seiflelnasr}

\cite{seifelnasrScalableOpenVoteNetwork2020}

\todo{Can't remember the detail, probably lots of smart contracts}

\subsection{LWE Based proposal - Chillotti}

\cite{chillottiHomomorphicLWEBased}

\todo{Post-Quantum, but otherwise, the voting is basically the same model as any homomorphic encryption based system}

\subsection{Vote-SAVER - Lee}

\cite{leeSAVERSNARKfriendlyAdditivelyhomomorphic2019}

\todo{This is interesting. based on a zkSNARK and smart contracts}

\subsection{Generic Cryptocurrency Based Voting - Yu}

\cite{yuPlatformindependentSecureBlockchainBased2018}

\todo{Is this the one with the Linkable Ring Signatures or the pre-populated crypto cards?}

\subsection{Trustless - Gajek}

\cite{gajekTrustlessCensorshipResilientScalable2019}

\todo{Maybe this is the linkable ring signatures}

\begin{table}[h]
    \centering
    \begin{tabular}{|Sr c c c c c c c c c c c c|}
        \hline
        Voting System                 & \rot{Correctness} & \rot{Secrecy} & \rot{Eligibility} & \rot{Fairness} & \rot{Robustness} & \rot{Receipt Freeness} & \rot{Coercion Resistance} & \rot{Individual Verifiability} & \rot{Universal Verifiability} & \rot{Auditability} & \rot{Real-time Universal Verifiability } & \rot{Eternal Secrecy} \\

        \hline\hline

        \textbf{Helios}               & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Belenios}             & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{i-Voting}             & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Zhao-Bitcoin}         & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Tarasov-ZCash}        & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Seiflelnasr-Ethereum} & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Chilloti-LWE}         & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Yu-Cryptocurrency}    & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
        \textbf{Trustless-Gajek}      & \YES              & \YES          & \YES              & \NO            & \NO              & \YES                   & \YES                      & \YES                           & \NO                           & \YES               & \NO                                      & \YES                  \\
        \hline
    \end{tabular}
    \caption{Table of Voting Systems and their Security Properties}
    \label{table:voting-system-props}
\end{table}

\todo{
    Import data from the google doc.
    Create a table.
    Discuss the systems.
}

